#basics #networking #internalPentest

### Scan Network Range

```
sudo nmap 10.129.2.0/24 -sn -oA tnet | grep for | cut -d" " -f5
```
![Alt text for your image](../../attchments/Exported%20image%2020241212230406-1.png)

### Scan IP List

lest suppose we have an list with alot of ips called hosts.lst

```
sudo nmap -sn -oA tnet -iL hosts.lst | grep for | cut -d" " -f5
```

![Pasted image 20250416103203](../../attchments/Pasted%20image%2020250416103203.png)


```
sudo nmap -sn -oA tnet 10.129.2.18 10.129.2.19 10.129.2.20| grep for | cut
-d" " -f5
```

```
sudo nmap -sn -oA tnet 10.129.2.18-20| grep for | cut -d" " -f5
```

### ping scan using nmap

```
sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace

sudo nmap 10.129.2.18 -sn -oA host -PE --reason

sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace --disable-arp-ping

```
![Pasted image 20250416104116](../../attchments/Pasted%20image%2020250416104116.png)


## UDP scan

```
sudo nmap 10.129.2.28 -F -sU
```

```
sudo nmap 10.129.2.28 -sU -Pn -n --disable-arp-ping --packet-trace -p 137
--reason
```

![Pasted image 20250416142748](../../attchments/Pasted%20image%2020250416142748.png)

---

```
xsltproc target.xml -o target.html
```
using the above command you can make an html file using xml file

# Service Enumeration

```
sudo nmap 10.129.2.28 -p- -sV
```

# Banner Grabbing

## tcpdump

```
sudo tcpdump -i eth0 host 10.10.14.2 and 10.129.2.28


tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
```



## nc

```
nc -nv 10.129.2.28 25
```


# Scripting

| Category  | Description                                                                                                                             |
| --------- | --------------------------------------------------------------------------------------------------------------------------------------- |
| auth      | Determination of authentication credentials.                                                                                            |
| broadcast | Scripts, which are used for host discovery by broadcasting and the discovered hosts, can be automatically added to the remaining scans. |
| brute     | Executes scripts that try to log in to the respective service by brute-forcing with credentials.                                        |


| Category  | Description                                                                                                                         |
| --------- | ----------------------------------------------------------------------------------------------------------------------------------- |
| default   | Default scripts executed by using the `-sC` option.                                                                                 |
| discovery | Evaluation of accessible services.                                                                                                  |
| dos       | These scripts are used to check services for denial of service vulnerabilities and are used less as it harms the services.          |
| exploit   | This category of scripts tries to exploit known vulnerabilities for the scanned port.                                               |
| external  | Scripts that use external services for further processing.                                                                          |
| fuzzer    | This uses scripts to identify vulnerabilities and unexpected packet handling by sending different fields, which can take much time. |
| intrusive | Intrusive scripts that could negatively affect the target system.                                                                   |
| malware   | Checks if some malware infects the target system.                                                                                   |
| Category  | Description                                                                                                                         |
| safe      | Defensive scripts that do not perform intrusive and destructive access.                                                             |
| version   | Extension for service detection.                                                                                                    |
| vuln      | Identification of specific vulnerabilities.                                                                                         |
|           |                                                                                                                                     |


```
Default Scripts
sudo nmap <target> -sC

Specific Scripts Category
sudo nmap <target> --script <category>

Defined Scripts
sudo nmap <target> --script <script-name>,<script-name>
```


```
sudo nmap 10.129.2.28 -p 80 -sV --script vuln
```




#  Firewall and IDS/IPS Evasion


**Ack scan
```
sudo nmap 10.129.2.28 -p 21,22,25 -sA -Pn -n --disable-arp-ping --packet-
trace
```

**Scan Using Decoy

```
sudo nmap 10.129.2.28 -p 80 -sS -Pn -n --disable-arp-ping --packet-trace -
D RND:5

```

![Pasted image 20250417155558](../../attchments/Pasted%20image%2020250417155558.png)

**Testing Firewall Rule

```
sudo nmap 10.129.2.28 -n -Pn -p445 -O
```

**Scan Using DIfferent source IP

```
sudo nmap 10.129.2.28 -n -Pn -p 445 -O -S 10.129.2.200 -e tun0
```


![Pasted image 20250417155722](../../attchments/Pasted%20image%2020250417155722.png)


## **Dns Proxying



**SYN-Scan From DNS Port

```
sudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace
--source-port 53
```

**Connect to Filtered port

```
ncat -nv --source-port 53 10.129.2.28 50000
```


# cheetsheet

|**Nmap Option**|**Description**|
|---|---|
|`10.10.10.0/24`|Target network range.|
|`-sn`|Disables port scanning.|
|`-Pn`|Disables ICMP Echo Requests|
|`-n`|Disables DNS Resolution.|
|`-PE`|Performs the ping scan by using ICMP Echo Requests against the target.|
|`--packet-trace`|Shows all packets sent and received.|
|`--reason`|Displays the reason for a specific result.|
|`--disable-arp-ping`|Disables ARP Ping Requests.|
|`--top-ports=<num>`|Scans the specified top ports that have been defined as most frequent.|
|`-p-`|Scan all ports.|
|`-p22-110`|Scan all ports between 22 and 110.|
|`-p22,25`|Scans only the specified ports 22 and 25.|
|`-F`|Scans top 100 ports.|
|`-sS`|Performs an TCP SYN-Scan.|
|`-sA`|Performs an TCP ACK-Scan.|
|`-sU`|Performs an UDP Scan.|
|`-sV`|Scans the discovered services for their versions.|
|`-sC`|Perform a Script Scan with scripts that are categorized as "default".|
|`--script <script>`|Performs a Script Scan by using the specified scripts.|
|`-O`|Performs an OS Detection Scan to determine the OS of the target.|
|`-A`|Performs OS Detection, Service Detection, and traceroute scans.|
|`-D RND:5`|Sets the number of random Decoys that will be used to scan the target.|
|`-e`|Specifies the network interface that is used for the scan.|
|`-S 10.10.10.200`|Specifies the source IP address for the scan.|
|`-g`|Specifies the source port for the scan.|
|`--dns-server <ns>`|DNS resolution is performed by using a specified name server.|

## Output Options

|**Nmap Option**|**Description**|
|---|---|
|`-oA filename`|Stores the results in all available formats starting with the name of "filename".|
|`-oN filename`|Stores the results in normal format with the name "filename".|
|`-oG filename`|Stores the results in "grepable" format with the name of "filename".|
|`-oX filename`|Stores the results in XML format with the name of "filename".|

## Performance Options

| **Nmap Option**              | **Description**                                              |
| ---------------------------- | ------------------------------------------------------------ |
| `--max-retries <num>`        | Sets the number of retries for scans of specific ports.      |
| `--stats-every=5s`           | Displays scan's status every 5 seconds.                      |
| `-v/-vv`                     | Displays verbose output during the scan.                     |
| `--initial-rtt-timeout 50ms` | Sets the specified time value as initial RTT timeout.        |
| `--max-rtt-timeout 100ms`    | Sets the specified time value as maximum RTT timeout.        |
| `--min-rate 300`             | Sets the number of packets that will be sent simultaneously. |
| `-T <0-5>`                   | Specifies the specific timing template.                      |